!function(){"use strict";angular.module("ui-router-history",["ui.router"]).factory("$stateHistory",["$rootScope","$state","$q",function(t,n,o){function r(t){a.unshift(t)}function e(){return a[0]}function i(){f=!0}function u(){f=!1}function s(){return f}var c={setLastState:r,getLastState:e,lockHistory:i,unlockHistory:u,isHistoryLocked:s},a=[],f=!1;return c.back=function(){s()||i();var t=e();return n.go(t.state.name,t.params).then(function(){a.splice(a.indexOf(t),1),u()})},c.getHistory=function(){return a},c.clear=function(){a=[]},c}]).run(["$rootScope","$stateHistory",function(t,n){t.$on("$stateChangeSuccess",function(t,o,r,e,i){return n.isHistoryLocked()?n.unlockHistory():void n.setLastState({state:e,params:i})})}])}();